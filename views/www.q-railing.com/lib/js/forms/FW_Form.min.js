var FW_Form=function(){this.init()};FW_Form.prototype={init:function(){this.blocker=!1,this.dependency_fields={}},start:function(){this.setEvents()},setEvents:function(){this.setInsideLabelsEvent(),this.setInsideLabelsLiveEvents(),this.initDependencyFields(),this.setDependencyFieldLiveEvents(),this.setSubmitEvent()},setInsideLabelsEvent:function(e){var t=this,n=e||$(".fw_form.fw_inside");n.length&&n.each(function(){var e=$(this).find('input[type="text"], textarea');e.length&&e.each(function(){var e=t.getLabelValue($(this));""===$(this).val()&&$(this).val(e)})})},removeInsideLabelValues:function(e){var t=this;if(e.length){var n=e.find('input[type="text"], textarea');n.length&&n.each(function(){var e=t.getLabelValue($(this));$(this).val()===e&&$(this).val("")})}},setInsideLabelsLiveEvents:function(){var e=this;$(document).on("focus",'.fw_form.fw_inside input[type="text"], .fw_form.fw_inside textarea',function(){var t=e.getLabelValue($(this));$(this).val()===t&&$(this).val("")}),$(document).on("blur",'.fw_form.fw_inside input[type="text"], .fw_form.fw_inside textarea',function(){var t=e.getLabelValue($(this));""===$(this).val()&&$(this).val(t)})},initDependencyFields:function(){var e=this,t=$(".fw_form");t.length&&t.each(function(){var t=$(this),n=$(this).find("option[data-dependency-source]");n.length&&n.each(function(){var t=$(this).parents("select:first");if(t.length&&t.attr("data-dependency-source")){var n=parseInt(t.attr("data-dependency-source")),i=parseInt($(this).attr("data-dependency-source")),a=$(this).val(),s=$(this).text(),r=$(this).selected;if(n&&i&&a&&s){e.dependency_fields.hasOwnProperty("select_"+n)||(e.dependency_fields["select_"+n]=[]);var c={};c.id=i,c.value=a,c.label=s,c.selected=r,e.dependency_fields["select_"+n].push(c)}}}),e.removeDependencyFieldOptions(t)})},removeDependencyFieldOptions:function(e){e.length&&this.dependency_fields&&$.each(this.dependency_fields,function(t,n){var i=parseInt(t.replace("select_",""));if(n.length)for(var a=0;a<n.length;a++){var s=n[a],r=parseInt(s.id),c=s.value,d=s.label;if(i&&r&&c&&d){var l=e.find('select[data-dependency-source="'+i+'"] option[data-dependency-source="'+r+'"]');l.length&&l.remove()}}})},resetSelectedDependencyFieldOption:function(e,t){if(e.length&&t.length){var n=t.attr("data-dependency-target");if(n){var i=n.split(",");if(i.length)for(var a=0;a<i.length;a++){var s=parseInt(i[a]),r=e.find('select[data-dependency-source="'+s+'"]');r.length&&r.prop("selectedIndex",0)}}}},getDependencyFieldOptionData:function(e){var t={};return e&&this.dependency_fields&&$.each(this.dependency_fields,function(n,i){var a=parseInt(n.replace("select_",""));if(i.length)for(var s=0;s<i.length;s++){var r=i[s],c=parseInt(r.id),d=r.value,l=r.label;if(a&&c&&c==e&&d&&l)return t["select_"+a]=r,t}}),t},setSelectedDependencyFieldOption:function(e,t){var n=this;e&&this.dependency_fields&&$.each(this.dependency_fields,function(i,a){var s=parseInt(i.replace("select_",""));if(e==s&&a.length){n.dependency_fields["select_"+s]=[];for(var r=0;r<a.length;r++){var c=a[r],d=parseInt(c.id);c.selected=!1,t&&d==t&&(c.selected=!0),n.dependency_fields["select_"+s].push(c)}}})},setDependencyFieldLiveEvents:function(){var e=this;$(document).off("change",".fw_form select[data-dependency-target]"),$(document).on("change",".fw_form select[data-dependency-target]",function(t,n){var i=$(this).parents(".fw_form:first"),a=$(this).attr("data-dependency-target");if(i.length&&a&&a.split(",").length){e.removeDependencyFieldOptions(i),n||e.resetSelectedDependencyFieldOption(i,$(this));var s=$(this).find("option:selected",this);if(s.length){var r=s.attr("data-dependency-target");if(r){var c=r.split(",");if(c.length)for(var d=0;d<c.length;d++){var l=parseInt(c[d]);if(l){var f=e.getDependencyFieldOptionData(l);f&&$.each(f,function(e,t){var n=parseInt(e.replace("select_",""));if(n&&t){var a=parseInt(t.id),s=t.value,r=t.label,c=t.selected,d=i.find('select[data-dependency-source="'+n+'"]');if(a&&s&&r&&d.length){var l=$("<option>",{"data-dependency-source":a,text:r,value:s,selected:c});d.append(l)}}})}}}}}}),$(document).off("change",".fw_form select[data-dependency-source]"),$(document).on("change",".fw_form select[data-dependency-source]",function(t,n){var i=$(this).find("option:selected",this);if(i.length){var a=parseInt($(this).attr("data-dependency-source")),s=parseInt(i.attr("data-dependency-source"));e.setSelectedDependencyFieldOption(a,s)}})},triggerDependencyFieldEvent:function(e){var t=e||$(".fw_form");t.length&&t.each(function(){var e=$(this).find("select[data-dependency-target]");e.length&&e.trigger("change",!0)})},getLabelValue:function(e){var t="";if(e.length){var n=e.parents(".fw_form_column:first").find("label:first");n.length&&(t=n.text())}return t},setSubmitEvent:function(){var e=this,t=document.querySelectorAll(".fw_form a.fw_form_submit_link");if(t.length)for(var n=0;n<t.length;n++){var i=t[n],a=i.getAttribute("data-click-event-listener");a&&window[a]&&i.removeEventListener("click",window[a],!1)}$(document).off("click",".fw_form a.fw_form_submit_link"),$(document).on("click",".fw_form a.fw_form_submit_link",function(){var t=$(this);return t.hasClass("g-recaptcha-v3")&&t.data("sitekey")?grecaptcha.ready(function(){grecaptcha.execute(t.data("sitekey"),{action:"submit"}).then(function(n){var i=t.parents(".fw_form:first");if(i.length){var a=i.find(".g-recaptcha-v3-response");a.length&&(a.val(n),e.submit(t))}})}):e.submit(t),!1})},submit:function(e){var t=this,n=e.parents(".fw_form_wrapper:first"),i=e.parents(".fw_form:first");if(n.length&&i.length&&!t.blocker)if(e.css({opacity:.25,cursor:"default"}),e.addClass("fw_disabled"),n.hasClass("fw_native"))i.hasClass("fw_inside")&&t.removeInsideLabelValues(i),i.submit();else if(t.blocker=!0,n.attr("id")){var a=i.attr("action");if(a)if(i.hasClass("fw_inside")&&t.removeInsideLabelValues(i),i.find(".fw_file_upload_iframe").length){var s={success:function(i,a,s,r){t.submitComplete(e,n,i)}};i.ajaxSubmit(s)}else $.post(a,i.serialize()).done(function(i){t.submitComplete(e,n,i)})}},submitComplete:function(e,t,n){var i=t.attr("id");e.css("opacity",""),e.css("cursor",""),e.removeClass("fw_disabled"),this.blocker=!1;var a=$("<div>").append(n).find("#"+i);a.length&&t.html(a.html());var s=t.find(".fw_form.fw_inside");s.length&&this.setInsideLabelsEvent(s);var r=t.find(".fw_form:first");r.length&&this.triggerDependencyFieldEvent(r);var c=t.find(".fw_form_feedback_error"),d=t.find(".fw_form_feedback_success");"object"==typeof grecaptcha&&fw_render_recaptchas(t),c.length&&($("html, body").animate({scrollTop:c.offset().top},500),"function"==typeof FW_formCallbackError&&FW_formCallbackError(n,e,t)),"function"==typeof FW_formCallbackSuccess&&d.length&&FW_formCallbackSuccess(n,e,t)}},$(document).ready(function(){(new FW_Form).start()}),window.fw_render_recaptchas=function(e){e=void 0!==e?e:document;$(e).find(".g-recaptcha").each(function(){grecaptcha.render(this,{sitekey:$(this).attr("data-sitekey")})})};